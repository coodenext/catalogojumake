// script.js (corrigido com localStorage)
const produtos = [
  {
    id: 1,
    nome: "KIT Primer Facial – Phállebeaut / Esponja Chanfrada / 4 Angels Corretivo Líquido",
    preco: 41.90,
    imagens: ["imagens/2 (1).jpg"], // Múltiplas imagens
    estoque: 4 // Quantidade em estoque
  },
  {
    id: 1,
    nome: "KIT On The Glow Blush – Fabella / Sérum Vitamina C – Phállebeauty / Iluminador Líquido - Febella",
    preco: 59.90,
    imagens: ["imagens/2 (2).jpg"], // Múltiplas imagens
    estoque: 1 // Quantidade em estoque
  },
  {
    id: 1,
    nome: "KIT Paleta de Blush Febella – 3 Tonalidades / Gel Creme Hidratante Facial – Phállebeauty / Gloss - Febella",
    preco: 56.90,
    imagens: ["imagens/2 (3).jpg"], // Múltiplas imagens
    estoque: 1 // Quantidade em estoque
  },
  {
    id: 1,
    nome: "4 Angels Corretivo Líquido",
    preco: 15.00,
    imagens: ["imagens/1 (1).jpg", "imagens/1 (1)b.jpeg"], // Múltiplas imagens
    descricao: "4 Angels Corretivo Líquido – Alta cobertura, toque leve e acabamento natural. Disfarça olheiras e imperfeições sem craquelar!",
    estoque: 5 // Quantidade em estoque
  },
  {
    id: 2,
    nome: "4 Angels PÓ COMPACTO",
    preco: 15.00,
    imagens: ["imagens/1 (2).jpg", "imagens/1 (2).jpeg"],
    descricao: "Acabamento aveludado, cobertura leve a média e controle da oleosidade. Ideal para selar a make e deixar a pele impecável o dia todo!",
    estoque: 1
  },
  {
    id: 3,
    nome: "Pó Banana / Bem Me Quero",
    preco: 11.00,
    imagens: ["imagens/1 (3).jpg"],
    descricao: "Pó Banana Bem Me Quero – Acabamento aveludado, controla a oleosidade e sela a maquiagem com leveza e perfeição!",
    estoque: 3 // Produto fora de estoque
  },
  {
    id: 4,
    nome: "Blindagem Febella",
    preco: 20.00,
    imagens: ["imagens/1 (4).jpg", "imagens/1 (4).jpeg"],
    descricao: "Blindagem Febella – Proteção intensa, brilho duradouro e cabelos mais fortes desde a primeira aplicação!",
    estoque: 3 // Produto fora de estoque
  },
  {
    id: 5,
    nome: "On The Glow Blush – Fabella",
    preco: 24.00,
    imagens: ["imagens/1 (5).jpg"],
    descricao: "On The Glow Blush – Fabella – Blush cremoso com efeito natural e luminoso, perfeito para um toque de cor e viço na pele!",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 6,
    nome: "Iluminador Líquido - Febella",
    preco: 23.00,
    imagens: ["imagens/1 (6).jpg", "imagens/1 (27).jpg"],
    descricao: " Iluminador Líquido – Febella – Brilho radiante e acabamento suave para realçar os pontos altos do rosto com naturalidade!",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 7,
    nome: "Paleta de Sombras Glam 12 S / Vivai",
    preco: 18.00,
    imagens: ["imagens/1 (25).jpg"],
    descricao: "Paleta de Sombras Glam 12 S – Vivai – Cores pigmentadas e versáteis, com acabamentos matte e cintilante para criar looks do dia à noite!",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 8,
    nome: "Máscara para Cílios Black ALL Day / Vivai",
    preco: 14.00,
    imagens: ["imagens/1 (24).jpg"],
    descricao: "Máscara para Cílios Black ALL Day – Vivai – Volume, definição e longa duração para cílios intensamente pretos o dia todo!",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 9,
    nome: "Lápis Marrom com Apontador – VIVAI",
    preco: 3.00,
    imagens: ["imagens/1 (23).jpg"],
    descricao: "Lápis Marrom com Apontador – VIVAI – Traço preciso, textura macia e praticidade com apontador acoplado! Ideal para olhos ou sobrancelhas.",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 10,
    nome: "Sabonete Líquido Moranguinho",
    preco: 8.00,
    imagens: ["imagens/1 (22).jpg"],
    descricao: "Sabonete Líquido Moranguinho – Limpeza suave com cheirinho delicioso de morango e toque hidratante para a pele!",
    estoque: 3 // Produto fora de estoque
  },
  {
    id: 11,
    nome: "Kit 13 Pincéis Profissionais",
    preco: 22.00,
    imagens: ["imagens/1 (20).jpg"],
    descricao: "Kit 13 Pincéis Profissionais – Conjunto completo para uma maquiagem impecável, com pincéis de alta qualidade para todos os detalhes!",
    estoque: 0 // Produto fora de estoque
  },
  {
    id: 12,
    nome: "Esponja Chanfrada",
    preco: 5.00,
    imagens: ["imagens/1 (19).jpg"],
    descricao: "Esponja Chanfrada – Aplicação precisa e uniforme, perfeita para contorno e áreas difíceis de alcançar. Deixa a maquiagem impecável!",
    estoque: 4 // Produto fora de estoque
  },
  {
    id: 13,
    nome: "Primer Facial – Phállebeaut",
    preco: 22.00,
    imagens: ["imagens/1 (18).jpg"],
    descricao: "Primer Facial – Phállebeaut – Preparação perfeita para a pele, controla a oleosidade e aumenta a durabilidade da maquiagem!",
    estoque: 4 // Produto fora de estoque
  },
  {
    id: 14,
    nome: "Bruma Matte – Phállebeaut",
    preco: 17.00,
    imagens: ["imagens/1 (17).jpg"],
    descricao: "Bruma Matte – Phállebeaut – Fixação prolongada e acabamento matte, controlando a oleosidade e deixando a maquiagem intacta o dia todo!",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 15,
    nome: "Kit Mini Esponjinhas – Powder Puf",
    preco: 7.00,
    imagens: ["imagens/1 (21).jpg"],
    descricao: "Kit Mini Esponjinhas – Powder Puf – Esponjinhas práticas e perfeitas para aplicação de pó, corretivo e retoques rápidos. Ideal para viagens!",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 16,
    nome: "Sérum Vitamina C – Phállebeauty",
    preco: 14.00,
    imagens: ["imagens/1 (31).jpeg"],
    descricao: "Máscara que alonga e dá volume aos cílios.",
    estoque: 1 // Produto fora de estoque
  },
  {
    id: 17,
    nome: "Máscara Facial Gold – Phállebeauty",
    preco: 17.00,
    imagens: ["imagens/1 (15).jpg"],
    descricao: "Máscara Facial Gold – Phállebeauty – Hidratação profunda e rejuvenescimento instantâneo, com efeito luminoso e revitalizante para a pele!",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 18,
    nome: "Gel Creme Hidratante Facial – Phállebeauty",
    preco: 20.00,
    imagens: ["imagens/1 (14).jpg"],
    descricao: "Gel Creme Hidratante Facial – Phállebeauty – Hidratação intensa e rápida absorção, deixando a pele macia, fresca e revitalizada!",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 19,
    nome: "Espuma Facial Morango - Nelô",
    preco: 17.00,
    imagens: ["imagens/1 (13).jpg"],
    descricao: "Espuma Facial Morango – Nelô – Limpeza suave com um toque doce de morango, removendo impurezas e deixando a pele macia e refrescante!",
    estoque: 1 // Produto fora de estoque
  },
  {
    id: 20,
    nome: "Gel Incolor Fix & Antifrizz – Mia Make",
    preco: 15.00,
    imagens: ["imagens/1 (12).jpg"],
    descricao: "Gel Incolor Fix & Antifrizz – Mia Make – Controle de frizz e fixação sem pesar, deixando o cabelo suave, disciplinado e com brilho natural",
    estoque: 3 // Produto fora de estoque
  },
  {
    id: 21,
    nome: "Base Líquida Lua e Neve",
    preco: 28.00,
    imagens: ["imagens/1 (11).jpg"],
    descricao: "Base Líquida Lua e Neve – Cobertura média e acabamento impecável, proporcionando uma pele uniforme e radiante o dia todo!",
    estoque: 0 // Produto fora de estoque
  },
  {
    id: 22,
    nome: "Paleta de Contorno Febella – 6 Cores",
    preco: 23.00,
    imagens: ["imagens/1 (32).jpeg", "imagens/1 (33).jpeg"],
    descricao: "Paleta de Contorno Febella – 6 Cores – Contorno perfeito com 6 tonalidades versáteis para modelar e iluminar o rosto de forma natural e sofisticada!",
    estoque: 4 // Produto fora de estoque
  },
  {
    id: 23,
    nome: "Paleta de Blush Febella – 3 Tonalidades",
    preco: 19.00,
    imagens: ["imagens/1 (9).jpg"],
    descricao: "Máscara que alonga e dá volume aos cílios.",
    estoque: 2 // Produto fora de estoque
  },
  {
    id: 24,
    nome: "Gloss Gold Magic – Febella",
    preco: 13.00,
    imagens: ["imagens/1 (8).jpg"],
    descricao: "Realce seus lábios com um acabamento luxuoso e radiante. Com partículas de brilho dourado, o Gold Magic oferece hidratação, volume e um visual glamouroso que transforma qualquer make. Ideal para quem ama se destacar!",
    estoque: 0 // Produto fora de estoque
  },
  {
    id: 25,
    nome: "Gloss - Febella",
    preco: 19.00,
    imagens: ["imagens/1 (7).jpg"],
    descricao: "Brilho intenso, lábios irresistíveis! Textura leve, hidratação na medida e um acabamento que valoriza qualquer look.",
    estoque: 1 // Produto fora de estoque
  },

];

const catalogo = document.getElementById("catalogo");

function carregarAvaliacoes() {
  return JSON.parse(localStorage.getItem('avaliacoes')) || {};
}

function salvarAvaliacoes(avaliacoes) {
  localStorage.setItem('avaliacoes', JSON.stringify(avaliacoes));
}

function criarEstrelas(id, notaAtual = 0) {
  const container = document.createElement('div');
  container.classList.add('estrelas');

  for (let i = 1; i <= 5; i++) {
    const estrela = document.createElement('span');
    estrela.innerHTML = i <= notaAtual ? '★' : '☆';
    estrela.style.cursor = 'pointer';
    estrela.style.fontSize = '20px';
    estrela.style.color = i <= notaAtual ? '#FFD700' : '#ccc';

    estrela.addEventListener('click', () => {
      const avaliacoes = carregarAvaliacoes();
      avaliacoes[id] = i;
      salvarAvaliacoes(avaliacoes);
      atualizarEstrelas(container, id, i);
    });

    container.appendChild(estrela);
  }

  return container;
}

function atualizarEstrelas(container, id, novaNota) {
  container.innerHTML = '';
  for (let i = 1; i <= 5; i++) {
    const estrela = document.createElement('span');
    estrela.innerHTML = i <= novaNota ? '★' : '☆';
    estrela.style.cursor = 'pointer';
    estrela.style.fontSize = '20px';
    estrela.style.color = i <= novaNota ? '#FFD700' : '#ccc';

    estrela.addEventListener('click', () => {
      const avaliacoes = carregarAvaliacoes();
      avaliacoes[id] = i;
      salvarAvaliacoes(avaliacoes);
      atualizarEstrelas(container, id, i);
    });

    container.appendChild(estrela);
  }
}

function avaliarProduto(event) {
  const produtoId = event.target.dataset.produtoId;
  const nota = parseInt(event.target.dataset.valor);
  const avaliacoes = carregarAvaliacoes();
  avaliacoes[produtoId] = nota;
  salvarAvaliacoes(avaliacoes);
  carregarProdutos();
}

function carregarProdutos() {
  catalogo.innerHTML = "";
  const avaliacoes = carregarAvaliacoes();

  produtos.forEach(produto => {
    const div = document.createElement("div");
    div.className = "produto";

    // Carrossel de imagens
    const carousel = document.createElement("div");
    carousel.className = "carousel";

    const imageContainer = document.createElement("div");
    imageContainer.className = "carousel-images";

    // Inicializa o índice da imagem
    let currentIndex = 0;

    // Exibe a primeira imagem
    const img = document.createElement("img");
    img.src = produto.imagens[currentIndex];
    img.alt = produto.nome;
    img.className = "carousel-image";
    img.onclick = () => abrirLightbox(produto);
    imageContainer.appendChild(img);

    const prevBtn = document.createElement("button");
    prevBtn.className = "prev";
    prevBtn.textContent = "‹";
    prevBtn.onclick = () => {
      currentIndex = (currentIndex - 1 + produto.imagens.length) % produto.imagens.length;
      img.src = produto.imagens[currentIndex];
    };

    const nextBtn = document.createElement("button");
    nextBtn.className = "next";
    nextBtn.textContent = "›";
    nextBtn.onclick = () => {
      currentIndex = (currentIndex + 1) % produto.imagens.length;
      img.src = produto.imagens[currentIndex];
    };

    carousel.appendChild(prevBtn);
    carousel.appendChild(imageContainer);
    carousel.appendChild(nextBtn);
    div.appendChild(carousel);

    // Informações do produto
    const info = document.createElement("div");
    info.className = "produto-info";

    const nome = document.createElement("h3");
    nome.textContent = produto.nome;
    info.appendChild(nome);

    // Adiciona a descrição do produto logo abaixo do nome
    const descricao = document.createElement("p");
    descricao.className = "produto-descricao";
    descricao.textContent = produto.descricao;
    info.appendChild(descricao);

    const preco = document.createElement("p");
    preco.textContent = `R$ ${produto.preco.toFixed(2)}`;

    const estoque = document.createElement("p");
    estoque.textContent = `Estoque: ${produto.estoque}`;

    const estrelas = criarEstrelas(produto.id, avaliacoes[produto.id] || 0);

    // Botão WhatsApp
    const botao = document.createElement("a");
    botao.className = "button";
    if (produto.estoque <= 0) {
      botao.textContent = "Indisponível";
      botao.classList.add("disabled");
      botao.removeAttribute("href"); // Remove link
      botao.style.pointerEvents = "none"; // Impede clique
      botao.style.opacity = "0.6"; // Visualmente mais claro
    } else {

      botao.textContent = "Comprar no WhatsApp";
      const mensagem = `Olá, tenho interesse neste produto!\n\nNome: ${produto.nome}\nValor: R$ ${produto.preco.toFixed(2)}`;
      const link = `https://wa.me/5587991065384?text=${encodeURIComponent(mensagem)}`;
      botao.href = link;
      botao.target = "_blank";
    }

    info.appendChild(nome);
    info.appendChild(preco);
    info.appendChild(estoque); // Adiciona o estoque abaixo do preço
    info.appendChild(estrelas);
    info.appendChild(botao);


    div.appendChild(info);
    catalogo.appendChild(div);
  });
}

function abrirLightbox(produto) {
  // Cria a estrutura do lightbox
  const lightbox = document.createElement('div');
  lightbox.className = 'lightbox';

  // Cria a imagem dentro do lightbox
  const lightboxImg = document.createElement('img');
  lightboxImg.src = produto.imagens[currentIndex];
  lightboxImg.alt = produto.nome;

  // Função para fechar o lightbox
  lightbox.onclick = () => {
    lightbox.remove();
  };

  // Adiciona a imagem no lightbox e o lightbox na página
  lightbox.appendChild(lightboxImg);
  document.body.appendChild(lightbox);
}


function fecharLightbox() {
  document.getElementById("lightbox").style.display = "none";
}

function voltarAoTopo() {
  window.scrollTo({ top: 0, behavior: "smooth" });
}

function filtrarProdutos() {
  const termo = document.getElementById("buscarProduto").value.toLowerCase();

  // Normalizando o termo de busca (removendo acentos)
  const termoNormalizado = termo.normalize("NFD").replace(/[\u0300-\u036f]/g, "");

  const produtosFiltrados = produtos.filter(produto => {
    // Normalizando o nome do produto (removendo acentos)
    const nomeProdutoNormalizado = produto.nome.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    return nomeProdutoNormalizado.includes(termoNormalizado);
  });

  catalogo.innerHTML = "";
  const avaliacoes = carregarAvaliacoes();

  produtosFiltrados.forEach(produto => {
    const div = document.createElement("div");
    div.className = "produto";

    // Carrossel de imagens
    const carousel = document.createElement("div");
    carousel.className = "carousel";
    const imageContainer = document.createElement("div");
    imageContainer.className = "carousel-images";

    let currentIndex = 0;
    const img = document.createElement("img");
    img.src = produto.imagens[currentIndex];
    img.alt = produto.nome;
    img.className = "carousel-image";
    img.onclick = () => abrirLightbox(produto);
    imageContainer.appendChild(img);

    const prevBtn = document.createElement("button");
    prevBtn.className = "prev";
    prevBtn.textContent = "‹";
    prevBtn.onclick = () => {
      currentIndex = (currentIndex - 1 + produto.imagens.length) % produto.imagens.length;
      img.src = produto.imagens[currentIndex];
    };

    const nextBtn = document.createElement("button");
    nextBtn.className = "next";
    nextBtn.textContent = "›";
    nextBtn.onclick = () => {
      currentIndex = (currentIndex + 1) % produto.imagens.length;
      img.src = produto.imagens[currentIndex];
    };

    carousel.appendChild(prevBtn);
    carousel.appendChild(imageContainer);
    carousel.appendChild(nextBtn);
    div.appendChild(carousel);

    // Informações do produto
    const info = document.createElement("div");
    info.className = "produto-info";

    const nome = document.createElement("h3");
    nome.textContent = produto.nome;

    const preco = document.createElement("p");
    preco.textContent = `R$ ${produto.preco.toFixed(2)}`;

    const estoque = document.createElement("p");
    estoque.textContent = `Estoque: ${produto.estoque}`;

    const estrelas = criarEstrelas(produto.id, avaliacoes[produto.id] || 0);

    // Botão WhatsApp
    const botao = document.createElement("a");
    botao.className = "button";
    if (produto.estoque <= 0) {
      botao.textContent = "Indisponível";
      botao.classList.add("disabled");
      botao.removeAttribute("href"); // Remove link
      botao.style.pointerEvents = "none"; // Impede clique
      botao.style.opacity = "0.6"; // Visualmente mais claro
    } else {
      botao.textContent = "Comprar no WhatsApp";
      const mensagem = `Olá, tenho interesse neste produto!\n\nNome: ${produto.nome}\nValor: R$ ${produto.preco.toFixed(2)}`;
      const link = `https://wa.me/5587991065384?text=${encodeURIComponent(mensagem)}`;
      botao.href = link;
      botao.target = "_blank";
    }

    info.appendChild(nome);
    info.appendChild(preco);
    info.appendChild(estoque); // Adiciona o estoque abaixo do preço
    info.appendChild(estrelas);
    info.appendChild(botao);

    div.appendChild(info);
    catalogo.appendChild(div);
  });
}

document.addEventListener("DOMContentLoaded", () => {
  carregarProdutos();

  // Quando digitar no campo de busca
  document.getElementById("buscarProduto").addEventListener("input", filtrarProdutos);

  // Se tiver um botão de buscar (opcional)
  const botaoBuscar = document.getElementById("btnBuscar");
  if (botaoBuscar) {
    botaoBuscar.addEventListener("click", filtrarProdutos);
  }
});


let slideIndex = 0;
const slides = document.querySelectorAll(".banner-slide");

function mostrarSlide(index) {
  slides.forEach((slide, i) => {
    slide.style.display = i === index ? "block" : "none";
  });
}

function changeSlide(direction) {
  slideIndex += direction;
  if (slideIndex >= slides.length) slideIndex = 0;
  if (slideIndex < 0) slideIndex = slides.length - 1;
  mostrarSlide(slideIndex);
}

// Inicializa o primeiro slide corretamente
mostrarSlide(slideIndex);

// Opcional: rotação automática a cada 5 segundos
setInterval(() => changeSlide(1), 5000);


// Função de navegação manual
function mudarSlide(direcao) {
  currentIndex += direcao;
  if (currentIndex < 0) {
    currentIndex = totalSlides - 1;
  } else if (currentIndex >= totalSlides) {
    currentIndex = 0;
  }

  atualizarBanner();
}

// Atualiza a posição do banner
function atualizarBanner() {
  const offset = -currentIndex * 100;
  document.querySelector('.banner').style.transform = `translateX(${offset}%)`;
}

// Mostrar o botão ao rolar a página
window.onscroll = function () {
  let botao = document.getElementById("btnTopo");
  if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
    botao.style.display = "block";
  } else {
    botao.style.display = "none";
  }
};

// Função para rolar até o topo
document.getElementById("btnTopo").onclick = function () {
  window.scrollTo({ top: 0, behavior: 'smooth' });
};


// Rolar a página para o topo ao clicar no botão
document.getElementById("btnTopo").onclick = function () {
  window.scrollTo({ top: 0, behavior: 'smooth' });
};

function transicaoAutomatica() {
  // Código da transição automática (exemplo)
  console.log("Transição automática acionada");
}

window.onscroll = function() {
  let btn = document.getElementById("btnTopo");
  if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
    btn.style.display = "block";
  } else {
    btn.style.display = "none";
  }
};

document.getElementById("btnTopo").addEventListener("click", function() {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});
